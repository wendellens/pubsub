<!DOCTYPE html>
<html>
<head>
  <title>PubSub Demo</title>
</head>
<body>
  <h2>📚Classroom</h2>

  <button id="subscribeA">Subscribe Student A to Math</button>
  <button id="subscribeB">Subscribe Student B to Math</button>
  <button id="publishMath">Publish Math Topic</button>
  <button id="clearLog">Clear Log</button>

  <div id="log"></div>
  
  <script>
    class PubSub {
      constructor() {
        this.topics = {};
      }

      subscribe(topic, listener) {
        if (!this.topics[topic]) {
          this.topics[topic] = [];
        }
        if (!this.topics[topic].includes(listener)) {
        this.topics[topic].push(listener
        }
      }

      publish(topic, data) {
        if (!this.topics[topic]) return;
        this.topics[topic].forEach(listener => listener(data));
      }

      unsubscribe(topic, listener) {
        if (!this.topics[topic]) return;
        this.topics[topic] = this.topics[topic].filter(l => l !== listener);
      }
    }

    const pubsub = new PubSub();

    function log(message) {
      const logDiv = document.getElementById('log');
      const entry = document.createElement('div');
      entry.textContent = message;
      logDiv.appendChild(entry);
    }

    function studentA(data) {
      log(`👩‍🎓 Student A received math update: ${data}`);
    }

    function studentB(data) {
      log(`👨‍🎓 Student B received math update: ${data}`);
    }

    document.getElementById('subscribeA').addEventListener('click', () => {
      pubsub.subscribe("math", studentA);
      log("✅ Student A subscribed to Math");
    });

    document.getElementById('subscribeB').addEventListener('click', () => {
      pubsub.subscribe("math", studentB);
      log("✅ Student B subscribed to Math");
    });

    document.getElementById('publishMath').addEventListener('click', () => {
      pubsub.publish("math", "New assignment: Algebra worksheet due Friday");
      log("📢 Teacher published Math topic");
    });

    document.getElementById('clearLog').addEventListener('click', () => {
      document.getElementById('log').innerHTML = "";
    });
  </script>
</body>
</html>
